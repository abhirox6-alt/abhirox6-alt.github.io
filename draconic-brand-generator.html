<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Draconic Brand Document Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://unpkg.com/mammoth@1.6.0/mammoth.browser.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200;12..96,400;12..96,700&display=swap');
    
    :root {
      --draconic-orange: #FF6D00;
      --draconic-dark: #1f1108;
      --draconic-brown-1: #54301e;
      --draconic-brown-2: #825037;
      --draconic-brown-3: #876959;
      --draconic-light: #f7d9cb;
      --draconic-accent: #e2ab8d;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Bricolage Grotesque', sans-serif;
      background: var(--draconic-dark);
      color: var(--draconic-light);
      line-height: 1.6;
      min-height: 100vh;
    }

    /* Generator UI */
    .generator-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px;
    }

    .generator-header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 30px;
      border-bottom: 3px solid var(--draconic-orange);
    }

    .generator-header img {
      height: 40px;
      margin-bottom: 20px;
    }

    .generator-header h1 {
      color: var(--draconic-orange);
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .generator-header p {
      color: var(--draconic-accent);
      font-size: 1.1rem;
    }

    .upload-section {
      background: rgba(255, 255, 255, 0.03);
      border: 3px dashed var(--draconic-brown-2);
      border-radius: 12px;
      padding: 60px;
      text-align: center;
      margin-bottom: 40px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .upload-section:hover,
    .upload-section.drag-over {
      border-color: var(--draconic-orange);
      background: rgba(255, 109, 0, 0.05);
    }

    .upload-section h2 {
      color: var(--draconic-orange);
      margin-bottom: 10px;
    }

    .upload-section p {
      color: var(--draconic-accent);
      margin-bottom: 20px;
    }

    input[type="file"] {
      display: none;
    }

    .file-types {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 20px;
    }

    .file-type {
      background: var(--draconic-brown-2);
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
    }

    .controls {
      display: none;
      margin-bottom: 40px;
      gap: 20px;
      align-items: center;
      justify-content: center;
    }

    .controls.active {
      display: flex;
    }

    button {
      background: var(--draconic-orange);
      color: var(--draconic-dark);
      border: none;
      padding: 12px 32px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(255, 109, 0, 0.5);
    }

    .filename {
      color: var(--draconic-accent);
      font-size: 1.1rem;
    }

    /* Status messages */
    .status {
      text-align: center;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      display: none;
    }

    .status.success {
      background: rgba(0, 255, 0, 0.1);
      border: 1px solid rgba(0, 255, 0, 0.3);
      color: #4ade80;
    }

    .status.error {
      background: rgba(255, 0, 0, 0.1);
      border: 1px solid rgba(255, 0, 0, 0.3);
      color: #f87171;
    }

  </style>
</head>
<body>
  <div class="generator-container">
    <div class="generator-header">
      <svg width="370.98" height="56.53" viewBox="0 0 370.98 56.53" style="height: 30px; width: auto;"><g><path fill="#FF6D00" d="M42.4,3.53h-7.07V0H0v56.53h35.33v-3.53h7.07v-3.53h3.53V7.07h-3.53v-3.53ZM35.33,49.46h-3.53v3.53H10.6V3.53h21.2v3.53h3.53v42.4Z"/><polygon fill="#FF6D00" points="286.19 0 286.19 38.86 282.65 38.86 282.65 31.8 279.12 31.8 279.12 24.73 275.59 24.73 275.59 17.67 272.05 17.67 272.05 10.6 268.52 10.6 268.52 3.53 264.99 3.53 264.99 0 254.39 0 254.39 56.53 264.99 56.53 264.99 14.13 268.52 14.13 268.52 21.2 272.05 21.2 272.05 28.27 275.59 28.27 275.59 35.33 279.12 35.33 279.12 42.4 282.65 42.4 282.65 49.46 286.19 49.46 286.19 56.53 296.79 56.53 296.79 0 286.19 0"/><polygon fill="#FF6D00" points="144.86 3.53 141.33 3.53 141.33 0 113.06 0 113.06 3.53 109.53 3.53 109.53 7.07 106 7.07 106 56.53 116.59 56.53 116.59 31.8 120.13 31.8 120.13 28.27 116.59 28.27 116.59 7.07 120.13 7.07 120.13 3.53 134.26 3.53 134.26 7.07 137.79 7.07 137.79 28.27 134.26 28.27 134.26 31.8 137.79 31.8 137.79 56.53 148.39 56.53 148.39 7.07 144.86 7.07 144.86 3.53"/><rect fill="#FF6D00" x="120.13" y="24.73" width="14.13" height="3.53"/><path fill="#FF6D00" d="M95.4,3.53h-7.07V0h-35.33v56.53h10.6v-24.73h21.2v3.53h3.53v21.2h10.6v-17.67h-3.53v-3.53h-3.53v-3.53h-3.53v-3.53h7.07v-3.53h3.53V7.07h-3.53v-3.53ZM88.33,24.73h-3.53v3.53h-21.2V3.53h21.2v3.53h3.53v17.67Z"/><polygon fill="#FF6D00" points="194.32 3.53 190.79 3.53 190.79 0 162.53 0 162.53 3.53 158.99 3.53 158.99 7.07 155.46 7.07 155.46 49.46 158.99 49.46 158.99 53 162.53 53 162.53 56.53 190.79 56.53 190.79 53 194.32 53 194.32 49.46 197.86 49.46 197.86 35.33 187.26 35.33 187.26 49.46 183.73 49.46 183.73 53 169.59 53 169.59 49.46 166.06 49.46 166.06 7.07 169.59 7.07 169.59 3.53 183.73 3.53 183.73 7.07 187.26 7.07 187.26 21.2 197.86 21.2 197.86 7.07 194.32 7.07 194.32 3.53"/><polygon fill="#FF6D00" points="370.98 21.2 370.98 7.07 367.45 7.07 367.45 3.53 363.92 3.53 363.92 0 335.65 0 335.65 3.53 332.12 3.53 332.12 7.07 328.59 7.07 328.59 49.46 332.12 49.46 332.12 53 335.65 53 335.65 56.53 363.92 56.53 363.92 53 367.45 53 367.45 49.46 370.98 49.46 370.98 35.33 360.38 35.33 360.38 49.46 356.85 49.46 356.85 53 342.72 53 342.72 49.46 339.18 49.46 339.18 7.07 342.72 7.07 342.72 3.53 356.85 3.53 356.85 7.07 360.38 7.07 360.38 21.2 370.98 21.2"/><path fill="#FF6D00" d="M243.79,3.53h-3.53V0h-28.27v3.53h-3.53v3.53h-3.53v42.4h3.53v3.53h3.53v3.53h28.27v-3.53h3.53v-3.53h3.53V7.07h-3.53v-3.53ZM236.72,49.46h-3.53v3.53h-14.13v-3.53h-3.53V7.07h3.53v-3.53h14.13v3.53h3.53v42.4Z"/><polygon fill="#FF6D00" points="303.85 0 303.85 3.53 307.39 3.53 307.39 53 303.85 53 303.85 56.53 321.52 56.53 321.52 53 317.99 53 317.99 3.53 321.52 3.53 321.52 0 303.85 0"/></g></svg>
      <h1>Brand Document Generator</h1>
      <p>Transform any document into Draconic-branded HTML</p>
    </div>

    <div class="upload-section" id="uploadArea">
      <h2>Upload Your Document</h2>
      <p>Drag & drop or click to select</p>
      <input type="file" id="fileInput" accept=".md,.markdown,.docx,.doc,.txt">
      <div class="file-types">
        <span class="file-type">.md</span>
        <span class="file-type">.markdown</span>
        <span class="file-type">.docx</span>
        <span class="file-type">.txt</span>
      </div>
    </div>

    <div class="controls" id="controls">
      <span class="filename" id="filename"></span>
      <button onclick="generateAndDownload()">Generate & Download HTML</button>
    </div>

    <div id="status" class="status"></div>
  </div>

  <script>
    let currentContent = '';
    let currentFilename = '';
    let generatedHTML = '';

    // File upload handling
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const controls = document.getElementById('controls');
    const filename = document.getElementById('filename');
    const status = document.getElementById('status');

    uploadArea.addEventListener('click', () => fileInput.click());

    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('drag-over');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('drag-over');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('drag-over');
      handleFile(e.dataTransfer.files[0]);
    });

    fileInput.addEventListener('change', (e) => {
      handleFile(e.target.files[0]);
    });

    function showStatus(message, type) {
      status.textContent = message;
      status.className = `status ${type}`;
      status.style.display = 'block';
      setTimeout(() => {
        status.style.display = 'none';
      }, 3000);
    }

    async function handleFile(file) {
      if (!file) return;

      currentFilename = file.name.replace(/\.[^/.]+$/, '');
      filename.textContent = file.name;

      const extension = file.name.split('.').pop().toLowerCase();

      try {
        if (extension === 'md' || extension === 'markdown' || extension === 'txt') {
          const reader = new FileReader();
          reader.onload = (e) => {
            currentContent = e.target.result;
            controls.classList.add('active');
            showStatus('File loaded successfully', 'success');
          };
          reader.readAsText(file);
        } else if (extension === 'docx' || extension === 'doc') {
          const reader = new FileReader();
          reader.onload = async (e) => {
            try {
              const arrayBuffer = e.target.result;
              const result = await mammoth.convertToHtml({ arrayBuffer: arrayBuffer });
              // Convert HTML to markdown-like format
              currentContent = htmlToMarkdown(result.value);
              controls.classList.add('active');
              showStatus('DOCX file converted successfully', 'success');
            } catch (error) {
              showStatus('Error reading DOCX file', 'error');
            }
          };
          reader.readAsArrayBuffer(file);
        } else {
          showStatus('Unsupported file type', 'error');
        }
      } catch (error) {
        showStatus('Error reading file', 'error');
      }
    }

    function htmlToMarkdown(html) {
      // Simple HTML to Markdown conversion
      return html
        .replace(/<h1[^>]*>(.*?)<\/h1>/gi, '# $1\n\n')
        .replace(/<h2[^>]*>(.*?)<\/h2>/gi, '## $1\n\n')
        .replace(/<h3[^>]*>(.*?)<\/h3>/gi, '### $1\n\n')
        .replace(/<h4[^>]*>(.*?)<\/h4>/gi, '#### $1\n\n')
        .replace(/<p[^>]*>(.*?)<\/p>/gi, '$1\n\n')
        .replace(/<br[^>]*>/gi, '\n')
        .replace(/<strong[^>]*>(.*?)<\/strong>/gi, '**$1**')
        .replace(/<b[^>]*>(.*?)<\/b>/gi, '**$1**')
        .replace(/<em[^>]*>(.*?)<\/em>/gi, '*$1*')
        .replace(/<i[^>]*>(.*?)<\/i>/gi, '*$1*')
        .replace(/<ul[^>]*>(.*?)<\/ul>/gis, (match, content) => {
          return content.replace(/<li[^>]*>(.*?)<\/li>/gi, '- $1\n') + '\n';
        })
        .replace(/<ol[^>]*>(.*?)<\/ol>/gis, (match, content) => {
          let counter = 1;
          return content.replace(/<li[^>]*>(.*?)<\/li>/gi, () => {
            return `${counter++}. $1\n`;
          }) + '\n';
        })
        .replace(/<[^>]+>/g, '');
    }

    function generateAndDownload() {
      if (!currentContent) {
        showStatus('No content to generate', 'error');
        return;
      }

      // Parse markdown
      const htmlContent = marked.parse(currentContent);

      // Generate branded HTML
      generatedHTML = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>${currentFilename} - Draconic</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200;12..96,400;12..96,700&display=swap');
    

    :root {
      --draconic-orange: #FF6D00;
      --draconic-dark: #1f1108;
      --draconic-brown-1: #54301e;
      --draconic-brown-2: #825037;
      --draconic-brown-3: #876959;
      --draconic-light: #f7d9cb;
      --draconic-accent: #e2ab8d;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Bricolage Grotesque', sans-serif;
      background: var(--draconic-dark);
      color: var(--draconic-light);
      line-height: 1.6;
      font-weight: 400;
      padding: 40px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 3px solid var(--draconic-orange);
    }

    .logo {
      height: 40px;
      margin-bottom: 10px;
    }

    .content {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 2rem;
      margin: 0 auto 40px;
      max-width: 1200px;
    }

    h1, h2, h3 {
      font-family: 'Bricolage Grotesque', sans-serif;
      font-weight: 700;
      color: var(--draconic-orange);
      margin: 1.5rem 0 1rem;
    }

    h1 { 
      font-size: 1.8rem; 
      text-transform: uppercase;
      letter-spacing: 0.02em;
    }
    
    h2 { 
      font-size: 1.6rem; 
      border-left: 4px solid var(--draconic-orange);
      padding-left: 1rem;
      background: linear-gradient(90deg, rgba(255, 109, 0, 0.1) 0%, transparent 50%);
    }
    
    h3 { 
      font-size: 1.3rem;
      color: var(--draconic-accent);
    }

    h4 {
      font-size: 1.1rem;
      color: var(--draconic-light);
      margin: 1rem 0 0.5rem;
    }

    p {
      margin-bottom: 1rem;
      color: var(--draconic-light);
    }

    code {
      background: rgba(0, 0, 0, 0.3);
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-family: 'Monaco', 'Consolas', monospace;
      color: var(--draconic-orange);
    }

    pre {
      background: rgba(0, 0, 0, 0.3);
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      margin: 1rem 0;
      border-left: 4px solid var(--draconic-orange);
    }

    pre code {
      background: none;
      padding: 0;
      color: var(--draconic-light);
    }

    blockquote {
      border-left: 4px solid var(--draconic-orange);
      padding-left: 1rem;
      margin: 1rem 0;
      color: var(--draconic-accent);
      font-style: italic;
      background: rgba(255, 109, 0, 0.05);
      padding: 1rem;
    }

    ul, ol {
      margin: 1rem 0 1rem 2rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    strong, b {
      color: var(--draconic-orange);
      font-weight: 700;
    }

    em, i {
      color: var(--draconic-accent);
    }

    a {
      color: var(--draconic-orange);
      text-decoration: underline;
    }

    hr {
      border: none;
      height: 2px;
      background: var(--draconic-orange);
      margin: 2rem 0;
      opacity: 0.3;
    }

    table {
      width: 100%;
      margin: 1.5rem 0;
      border-collapse: collapse;
    }

    th {
      background: rgba(255, 109, 0, 0.15);
      color: var(--draconic-light);
      font-weight: 600;
      padding: 12px;
      text-align: left;
      border-bottom: 2px solid var(--draconic-orange);
    }

    td {
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    tr:nth-child(even) {
      background: rgba(255, 255, 255, 0.02);
    }

    .footer {
      text-align: center;
      padding-top: 40px;
      margin-top: 60px;
      border-top: 2px solid var(--draconic-accent);
      color: var(--draconic-accent);
    }
  </style>
</head>
<body>
  <div class="header">
    <svg width="370.98" height="56.53" viewBox="0 0 370.98 56.53" style="height: 30px; width: auto; display: block; margin: 0 auto 15px;"><g><path fill="#FF6D00" d="M42.4,3.53h-7.07V0H0v56.53h35.33v-3.53h7.07v-3.53h3.53V7.07h-3.53v-3.53ZM35.33,49.46h-3.53v3.53H10.6V3.53h21.2v3.53h3.53v42.4Z"/><polygon fill="#FF6D00" points="286.19 0 286.19 38.86 282.65 38.86 282.65 31.8 279.12 31.8 279.12 24.73 275.59 24.73 275.59 17.67 272.05 17.67 272.05 10.6 268.52 10.6 268.52 3.53 264.99 3.53 264.99 0 254.39 0 254.39 56.53 264.99 56.53 264.99 14.13 268.52 14.13 268.52 21.2 272.05 21.2 272.05 28.27 275.59 28.27 275.59 35.33 279.12 35.33 279.12 42.4 282.65 42.4 282.65 49.46 286.19 49.46 286.19 56.53 296.79 56.53 296.79 0 286.19 0"/><polygon fill="#FF6D00" points="144.86 3.53 141.33 3.53 141.33 0 113.06 0 113.06 3.53 109.53 3.53 109.53 7.07 106 7.07 106 56.53 116.59 56.53 116.59 31.8 120.13 31.8 120.13 28.27 116.59 28.27 116.59 7.07 120.13 7.07 120.13 3.53 134.26 3.53 134.26 7.07 137.79 7.07 137.79 28.27 134.26 28.27 134.26 31.8 137.79 31.8 137.79 56.53 148.39 56.53 148.39 7.07 144.86 7.07 144.86 3.53"/><rect fill="#FF6D00" x="120.13" y="24.73" width="14.13" height="3.53"/><path fill="#FF6D00" d="M95.4,3.53h-7.07V0h-35.33v56.53h10.6v-24.73h21.2v3.53h3.53v21.2h10.6v-17.67h-3.53v-3.53h-3.53v-3.53h-3.53v-3.53h7.07v-3.53h3.53V7.07h-3.53v-3.53ZM88.33,24.73h-3.53v3.53h-21.2V3.53h21.2v3.53h3.53v17.67Z"/><polygon fill="#FF6D00" points="194.32 3.53 190.79 3.53 190.79 0 162.53 0 162.53 3.53 158.99 3.53 158.99 7.07 155.46 7.07 155.46 49.46 158.99 49.46 158.99 53 162.53 53 162.53 56.53 190.79 56.53 190.79 53 194.32 53 194.32 49.46 197.86 49.46 197.86 35.33 187.26 35.33 187.26 49.46 183.73 49.46 183.73 53 169.59 53 169.59 49.46 166.06 49.46 166.06 7.07 169.59 7.07 169.59 3.53 183.73 3.53 183.73 7.07 187.26 7.07 187.26 21.2 197.86 21.2 197.86 7.07 194.32 7.07 194.32 3.53"/><polygon fill="#FF6D00" points="370.98 21.2 370.98 7.07 367.45 7.07 367.45 3.53 363.92 3.53 363.92 0 335.65 0 335.65 3.53 332.12 3.53 332.12 7.07 328.59 7.07 328.59 49.46 332.12 49.46 332.12 53 335.65 53 335.65 56.53 363.92 56.53 363.92 53 367.45 53 367.45 49.46 370.98 49.46 370.98 35.33 360.38 35.33 360.38 49.46 356.85 49.46 356.85 53 342.72 53 342.72 49.46 339.18 49.46 339.18 7.07 342.72 7.07 342.72 3.53 356.85 3.53 356.85 7.07 360.38 7.07 360.38 21.2 370.98 21.2"/><path fill="#FF6D00" d="M243.79,3.53h-3.53V0h-28.27v3.53h-3.53v3.53h-3.53v42.4h3.53v3.53h3.53v3.53h28.27v-3.53h3.53v-3.53h3.53V7.07h-3.53v-3.53ZM236.72,49.46h-3.53v3.53h-14.13v-3.53h-3.53V7.07h3.53v-3.53h14.13v3.53h3.53v42.4Z"/><polygon fill="#FF6D00" points="303.85 0 303.85 3.53 307.39 3.53 307.39 53 303.85 53 303.85 56.53 321.52 56.53 321.52 53 317.99 53 317.99 3.53 321.52 3.53 321.52 0 303.85 0"/></g></svg>
  </div>

  <div class="content">
    ${htmlContent}
  </div>

  <div class="footer">
    <div>Â© ${new Date().getFullYear()} Draconic AI</div>
  </div>
</body>
</html>`;

      // Immediately download the file
      const blob = new Blob([generatedHTML], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${currentFilename}-draconic.html`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      
      showStatus('HTML file downloaded successfully!', 'success');
    }

  </script>

</body>
</html>